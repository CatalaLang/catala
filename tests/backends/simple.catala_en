```catala
declaration structure Foo:
  data x content boolean
  data y content decimal

declaration enumeration Bar:
  -- No
  -- Yes content Foo

#[test]
declaration scope Baz:
  context a content Bar
  output b content decimal
  output c content list of decimal

scope Baz:
  definition a equals No

  definition b equals
    match a with pattern
    -- No: 0.0
    -- Yes content foo: foo.y + if foo.x then 1.0 else 0.0

  exception definition b under condition
    a with pattern No
  consequence equals 42.0

  definition c equals [b;b]
```


```catala-test-cli
$ catala c
/* This file has been generated by the Catala compiler, do not edit! */

#include <stdio.h>
#include <stdlib.h>
#include <catala_runtime.h>

#include <Stdlib_en.h>
#include <Date_en.h>
#include <List_en.h>
#include <Duration_en.h>
#include <MonthYear_en.h>
#include <Period_en.h>
#include <Money_en.h>
#include <Integer_en.h>
#include <Decimal_en.h>

typedef struct Foo {
  CATALA_BOOL x;
  CATALA_DEC y;
} Foo;

typedef struct Baz {
  CATALA_DEC b;
  const CATALA_ARRAY(CATALA_DEC) c;
} Baz;

enum Bar__code {
  Bar__NO,
  Bar__YES
};

typedef struct Bar {
  enum Bar__code code;
  union {
    CATALA_UNIT Bar__NO;
    const Foo* Bar__YES;
  } payload;
} Bar;

typedef struct Baz_in {
  const CATALA_OPTION(CATALA_TUPLE(Bar*;CATALA_POSITION)) a_in;
} Baz_in;

const Baz* baz (const Baz_in* baz_in)
{
  const CATALA_OPTION(CATALA_TUPLE(Bar*;CATALA_POSITION)) a = baz_in->a_in;
  const CATALA_OPTION(CATALA_TUPLE(Bar*;CATALA_POSITION)) a__1;
  CATALA_DEC b;
  const CATALA_OPTION(CATALA_TUPLE(CATALA_DEC;CATALA_POSITION)) b__1;
  const CATALA_OPTION(CATALA_TUPLE(CATALA_DEC;CATALA_POSITION)) b__2;
  CATALA_BOOL b__3;
  const Bar* b__4;
  const CATALA_ARRAY(CATALA_DEC) c;
  CATALA_ARRAY(CATALA_DEC) const c__3 = catala_malloc(sizeof(catala_array));
  static const catala_code_position pos[1] =
    {{"tests/backends/simple.catala_en", 28, 23, 28, 28}};
  CATALA_TUPLE(CATALA_ARRAY(CATALA_DEC);CATALA_POSITION) const c__2 =
    catala_malloc(2 * sizeof(tuple_element*));
  const CATALA_OPTION(CATALA_TUPLE(CATALA_ARRAY(CATALA_DEC);CATALA_POSITION))
    c__1;
  Baz* const baz__1 = catala_malloc(sizeof(Baz));
  if (a->code == catala_option_some) {
    const CATALA_TUPLE(Bar*;CATALA_POSITION) x = a->payload;
    a__1 = catala_some(x);
  } else {
    Bar* const a__3 = catala_malloc(sizeof(Bar));
    static const catala_code_position pos[1] =
      {{"tests/backends/simple.catala_en", 17, 23, 17, 25}};
    CATALA_TUPLE(Bar*;CATALA_POSITION) const a__2 =
      catala_malloc(2 * sizeof(tuple_element*));
    a__3->code = Bar__NO;
    a__3->payload.Bar__NO = CATALA_UNITVAL;
    a__2[0].content = a__3;
    a__2[1].content = pos;
    a__1 = catala_some(a__2);
  }
  if (a__1->code == catala_option_some) {
    const CATALA_TUPLE(Bar*;CATALA_POSITION) arg = a__1->payload;
    b__4 = ((Bar*)(arg[0].content));
  } else {
    static const catala_code_position pos[1] =
      {{"tests/backends/simple.catala_en", 25, 5, 25, 6}};
    catala_error(catala_no_value, pos, 1, NULL);
    abort();
  }
  switch (b__4->code) {
    case Bar__NO: {
      b__3 = CATALA_TRUE;
      break;
    }
    case Bar__YES: {
      b__3 = CATALA_FALSE;
      break;
    }
    default:
      abort();
  }
  if (b__3 == CATALA_TRUE) {
    static const catala_code_position pos[1] =
      {{"tests/backends/simple.catala_en", 26, 22, 26, 26}};
    CATALA_TUPLE(CATALA_DEC;CATALA_POSITION) const b__5 =
      catala_malloc(2 * sizeof(tuple_element*));
    b__5[0].content = catala_new_dec_str("42");
    b__5[1].content = pos;
    b__2 = catala_some(b__5);
  } else {
    b__2 = CATALA_NONE;
  }
  if (b__2->code == catala_option_some) {
    const CATALA_TUPLE(CATALA_DEC;CATALA_POSITION) x = b__2->payload;
    b__1 = catala_some(x);
  } else {
    CATALA_DEC b__6;
    const Bar* b__7;
    static const catala_code_position pos[1] =
      {{"tests/backends/simple.catala_en", 20, 5, 22, 59}};
    CATALA_TUPLE(CATALA_DEC;CATALA_POSITION) const b__5 =
      catala_malloc(2 * sizeof(tuple_element*));
    if (a__1->code == catala_option_some) {
      const CATALA_TUPLE(Bar*;CATALA_POSITION) arg = a__1->payload;
      b__7 = ((Bar*)(arg[0].content));
    } else {
      static const catala_code_position pos[1] =
        {{"tests/backends/simple.catala_en", 20, 11, 20, 12}};
      catala_error(catala_no_value, pos, 1, NULL);
      abort();
    }
    switch (b__7->code) {
      case Bar__NO: {
        b__6 = catala_new_dec_str("0");
        break;
      }
      case Bar__YES: {
        const Foo* foo = b__7->payload.Bar__YES;
        CATALA_DEC b__8;
        if (foo->x == CATALA_TRUE) {
          b__8 = catala_new_dec_str("1");
        } else {
          b__8 = catala_new_dec_str("0");
        }
        b__6 = o_add_rat_rat(foo->y, b__8);
        break;
      }
      default:
        abort();
    }
    b__5[0].content = b__6;
    b__5[1].content = pos;
    b__1 = catala_some(b__5);
  }
  if (b__1->code == catala_option_some) {
    const CATALA_TUPLE(CATALA_DEC;CATALA_POSITION) arg = b__1->payload;
    b = ((CATALA_DEC)(arg[0].content));
  } else {
    static const catala_code_position pos[1] =
      {{"tests/backends/simple.catala_en", 13, 10, 13, 11}};
    catala_error(catala_no_value, pos, 1, NULL);
    abort();
  }
  c__3->size = 2;
  c__3->elements = catala_malloc(2 * sizeof(void*));
  c__3->elements[0] = b;
  c__3->elements[1] = b;
  c__2[0].content = c__3;
  c__2[1].content = pos;
  c__1 = catala_some(c__2);
  if (c__1->code == catala_option_some) {
    const CATALA_TUPLE(CATALA_ARRAY(CATALA_DEC);CATALA_POSITION)
      arg = c__1->payload;
    c = ((CATALA_ARRAY(CATALA_DEC))(arg[0].content));
  } else {
    static const catala_code_position pos__1[1] =
      {{"tests/backends/simple.catala_en", 14, 10, 14, 11}};
    catala_error(catala_no_value, pos__1, 1, NULL);
    abort();
  }
  baz__1->b = b;
  baz__1->c = c;
  return baz__1;
}

```
